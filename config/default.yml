data:
  manifest_train: manifests/train.csv
  manifest_val:   manifests/val.csv
  manifest_test:  no #manifests/test.csv

  image_col: image_path
  presence_col: presence
  cx_col: cx
  cy_col: cy

  use_pre_letterboxed: true
  letterbox_meta_csv: letterbox_meta.csv  # prodotto dallo script
  letterbox_size_assert: 384   # per sicurezza: deve coincidere con out_size nel CSV

train:
  image_size: 384
  batch_size: 256   # per GPU; global = batch_size * world_size
  num_workers: 0
  dataloader_timeout_s: 60   # >0 per evitare deadlock: solleva eccezione se il dataloader si blocca
  persistent_workers: false   # disattiva (false) se sospetti deadlock dei worker tra le epoche
  epochs: 500
  lr: 2.0e-4
  weight_decay: 1.0e-4
  amp: true
  scale_lr_by_world_size: true
  seed: 491
  save_dir: checkpoints
  val_every: 2
  best_ckpt_start_epoch: 5
  backbone: resnet18        # resnet18|resnet50
  heatmap_stride: 4         # output 128x128 quando input 512
  use_aug: false            # puoi mettere true se serve
  temporal_T: 3             # numero di frame temporali (early fusion canali)
  temporal_stride: 6        # salto tra frame temporali (>=1)

loss:
  heatmap_sigma_px: 8
  w_heatmap: 100.0
  w_presence: 1.0
  auto_balance: false          # bilancia automaticamente le magnitudini di heatmap e presence
  auto_balance_clip: [0.1, 100.0]

infer:
  batch_size: 128
  presence_threshold: 0.5
  topk_peaks: 1
  roi_base_radius_px: 112    # met√† tile 224
  roi_sigma_multiplier: 2.5
  out_dir: outputs/preds
